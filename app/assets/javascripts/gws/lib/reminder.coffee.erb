class @Gws_Reminder
  @renderAddon: (opts = {})->
    addon = $(".gws-addon-reminder")

    params = {
      data:
        item:
          item_id: addon.find("#item_id").val()
          model: addon.find("#item_model").val()
          name: addon.find("#item_name").val()
      beforeSend: (data)->
        $(".gws-addon-reminder-label").html("")
      success: (data)->
        $(".gws-addon-reminder-label").html(data)
      error: (data)->
        alert("Error")
    }
    $.extend true, params, opts

    $("#gws-addon-reminder-set").click ->
      ajax_params = { method: "post" }
      $.extend true, ajax_params, params
      ajax_params["data"]["item"]["date"] = addon.find("#item_date").val()
      $.ajax(ajax_params)

    $("#gws-addon-reminder-unset").click ->
      ajax_params = { method: "post" }
      $.extend true, ajax_params, params
      ajax_params["data"]["_method"] = "delete"
      $.ajax(ajax_params)

  @renderList: (opts = {})->
    $('.list-item').each ->
      $(this).find('.links').append('<a class="restore" href="#" style="display: none;"><%= I18n.t('gws.links.restore_reminder') %></a>')

    $('.list-item .delete').click ->
      item = $(this).closest('.list-item')
      $.ajax
        url: opts['url']
        method: 'post'
        data:
          _method: 'delete'
          item:
            item_id: item.data('id')
            model: item.data('model')
            name: item.data('name')
            date: item.data('date')
        success: (data)->
          item.toggleClass('gws-list-item--deleted').find('.check, .meta, .delete').hide()
          item.find('.restore').show()
          return false
        error: (data)->
          alert('Error')

    $('.list-item .restore').click ->
      item = $(this).closest('.list-item')
      $.ajax
        url: opts['url']
        method: 'post'
        data:
          item:
            item_id: item.data('id')
            model: item.data('model')
            name: item.data('name')
            date: item.data('date')
        success: (data)->
          item.toggleClass('gws-list-item--deleted').find('.check, .meta, .delete').show()
          item.find('.restore').hide()
          return false
        error: (data)->
          alert('Error')
