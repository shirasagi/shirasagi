<%
  calendar_options = {
    tapMenu: @user.blank? || @user.id == @cur_user.id,
    restUrl: url_for(action: :index),
    eventSources: [{ url: "#{url_for(action: :events, format: :json)}?#{search_query}" }]
  }
  if @cur_site.schedule_drag_drop_denied?
    calendar_options[:eventStartEditable] = false
  end

  init_options = params[:calendar] || {}
%>
<%= jquery do %>
Gws_Schedule_Calendar.render('#calendar', <%== calendar_options.to_json %>, <%== init_options.to_json %>);
<% end %>

<%= render "gws/schedule/main/tabs" %>

<section class="main-box gws-schedule-box">
  <div class="card mb-5">
    <div class="card-body d-flex flex-wrap justify-content-between">
      <%= render file: '_search' %>
    </div>
  </div>
  <header class="d-flex flex-wrap mb-3 align-items-center">
    <h2><%= (@user || @cur_user).long_name %></h2>
    <% if @user.blank? || @user.id == @cur_user.id %>
      <%= link_to t('gws/schedule.links.add_plan'), { action: :new }, { class: 'add-plan btn btn-outline-primary ml-3 mb-0' } %>
    <% end %>
  </header>
  <div id="calendar" class="calendar"></div>
</section>
