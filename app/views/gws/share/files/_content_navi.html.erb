<%
  options = options_for_select(@categories.to_options(offset: 1), @category.try(:id))
%>
<%= jquery do %>
  $(".gws-category-navi-menu #category_id").change(function() {
  var cid = $(this).val();
  <% if @folder %>
    if (cid) location.href = '<%= gws_share_folder_files_path(folder: @folder.id, category: 'ID') %>'.replace('ID', cid);
    else location.href = '<%= gws_share_folder_files_path(folder: @folder.id) %>';
  <% else %>
    if (cid) location.href = '<%= gws_share_files_path(category: 'ID') %>'.replace('ID', cid);
    else location.href = '<%= gws_share_files_path %>';
  <% end %>
  });

  (new SS_TreeNavi('#content-navi .tree-navi')).render("<%= @tree_navi %>");
<% end %>

<div class="gws-category-navi-menu">
  <%= select_tag :category_id, options, include_blank: t('modules.gws/share') if @categories.to_options.present? %>
</div>

<% if params[:action] == "index" %>
  <div id="content-navi">
    <h2 class="content-navi-title">
      <%= t("gws/share.folder") %>
    </h2>

    <div class="tree-item<%= ' is-current' if @folder.blank? %>">
      <%= link_to t('gws/share.all'), gws_share_files_path %>
    </div>
    <div class="tree-navi"></div>
  </div>
<% end %>

