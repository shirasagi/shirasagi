<div class="btn-group">
  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    <% if @cur_group %>
      <span class="group"><%= @cur_group.trailing_name %></span>
    <% end %>
    <span class="name"><%= @cur_user.name %></span>
  </button>
  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    <% @account_menu.to_a.each do |link_params| %>
      <%= link_to *link_params, class: "dropdown-item" %>
    <% end %>
    <%= link_to t(:"sns.profile"), sns_cur_user_profile_path, class: "dropdown-item" %>
    <div class="text-zoom dropdown-item btn-group flex-nowrap" role="group" data-notice="<%= t('ss.notice.text_zoomed', count: ':size') %>">
      <div><%= t('ss.text_zoom') %></div>
      <div class="wrap">
        <span class="btn btn-secondary"><%= t('ss.options.text_zoom.zoom_out') %></span><span class="btn btn-secondary"><%= t('ss.options.text_zoom.reset') %></span><span class="btn btn-secondary"><%= t('ss.options.text_zoom.zoom_in') %></span>
      </div>
    </div>
    <% if @ss_mode == :gws && @cur_site.menu_contrast_visible? %>
      <div class="gws-contrast cascade-menu dropdown-item" data-ref="#user-contrast-menu">
        <label><%= @cur_site.menu_contrast_label.presence || t('mongoid.models.gws/contrast') %></label>
        <span class="caret"><i class="material-icons">&#xE315;</i></span>
      </div>
    <% end %>
    <%= link_to t('ss.logout'), (@logout_path || sns_logout_path), class: 'logout dropdown-item' %>
  </div>
  <% if @ss_mode == :gws && @cur_site.menu_contrast_visible? %>
    <ul id="user-contrast-menu" class="ss-dropdown-menu cascade-sub-menu">
      <li class="user-contrast-menu-header">
        <a href="#user-main-dropdown" class="cascade-back">
          <i class="material-icons caret">&#xE314;</i><%= @cur_site.menu_contrast_label.presence || t('mongoid.models.gws/contrast') %>
        </a>
      </li>
      <li>
        <div class="gws-contrast-loading">
          <img style="vertical-align:middle" src="/assets/img/loading.gif" alt="loading.." border="0" widtth="16" height="11" />
        </div>
      </li>
    </ul>
    <%= jquery do %>
      var contrast = new Gws_Contrast({
        siteId: <%== @cur_site.id.to_json %>,
        url: <%== gws_apis_contrasts_path(format: 'json').to_json %>,
        defaultContrast: <%== t('gws.default_contrast').to_json %>,
        notice: <%== t('gws.notice.contrast_changed', name: ':name').to_json %>,
        loadError: <%== t('mongoid.errors.models.gws/contrast.load_error').to_json %>,
        noContrasts: <%== t('mongoid.errors.models.gws/contrast.no_contrasts').to_json %>
      });

      <% if cookies["gws-contrast-#{@cur_site.id}"].present? %>
        <% contrast = Gws::Contrast.site(@cur_site).and_public.find(cookies["gws-contrast-#{@cur_site.id}"]) rescue nil %>
        <% if contrast.present? %>
          contrast.changeContrast(<%== contrast.text_color.to_json %>, <%== contrast.color.to_json %>);
        <% end %>
      <% end %>
    <% end %>
  </div>
<% end %>
