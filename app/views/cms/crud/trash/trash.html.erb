<% @tap_menu = proc do |item| %>
  <%= link_to t('ss.links.show'), action: :show, id: item if item.allowed?(:read, @cur_user, site: @cur_site) %>
  <%= link_to t('ss.links.edit'), action: :edit, id: item if item.allowed?(:edit, @cur_user, site: @cur_site) %>
  <% if item.allowed?(:delete, @cur_user, site: @cur_site) %>
    <%= link_to t('ss.links.restore'), action: :undo_delete, id: item %>
    <%= link_to t('ss.links.delete'), action: :delete, id: item %>
  <% end %>

  <% if @model.collection_name == :cms_nodes %>
    <%= link_to t('ss.links.view_site'), item.full_url, target: :_blank if item.public? %>
    <% if @cur_site.mobile_enabled? %>
      <%= link_to t('ss.links.pc_preview'), cms_preview_path(path: item.preview_path), target: :_blank %>
      <%= link_to(t('ss.links.mobile_preview'), cms_mobile_preview_path(path: item.preview_path), target: :_blank) %>
    <% else %>
      <%= link_to t('ss.links.preview'), cms_preview_path(path: item.preview_path), target: :_blank %>
    <% end %>
  <% elsif @model.collection_name == :cms_pages %>
    <%= link_to t('ss.links.view_site'), item.full_url, target: :_blank if item.public? %>
    <% if @cur_site.mobile_enabled? %>
      <%= link_to t('ss.links.pc_preview'), cms_preview_path(path: item.preview_path), target: :_blank %>
      <%= link_to(t('ss.links.mobile_preview'), cms_mobile_preview_path(path: item.preview_path), target: :_blank) %>
    <% else %>
      <%= link_to t('ss.links.preview'), cms_preview_path(path: item.preview_path), target: :_blank %>
    <% end %>
  <% end %>

  <% if item.try(:image) %>
    <%= link_to image_tag(item.image.thumb_url), item.image.url, { class: "thumb", target: "_blank" } %>
  <% elsif item.try(:image?) %>
    <%= link_to image_tag(item.thumb_url), item.url, { class: "thumb", target: "_blank" } %>
  <% end %>
<% end %>

<%= render file: 'cms/crud/index' %>
