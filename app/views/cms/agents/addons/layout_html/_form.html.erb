<%= code_editor ".mod-cms-html-form textarea", mode: :html %>
<dl class="see mod-cms-body" data-syntax-check="editor">
  <dt class="wide"><%= @model.t :html %><%= @model.tt :html %></dt>
  <dd class="wide">
    <%= f.text_area :html, style: "height: 400px", data: { syntax_check: 'editor', syntax_check_name: t("modules.addons.cms/body_layout_html") } %>

    <% if example = @item.try(:form_example_layout_html) %>
      <div class="form-example">
        <div class="form-example-head example-layout-html"><%= t 'ss.input_example' %></div>
        <div class="form-example-body example-layout-html"><%= example %></div>
      </div>
    <% end %>
  </dd>
</dl>

<% if @syntax_checker && @syntax_checker.errors.present? %>
<script>
  $(function() {
    // 既存のSyntax_Checkerの初期化
    if (!Syntax_Checker.form) {
      Syntax_Checker.form = Cms_Form;
    }

    // ResultBoxの初期化（エラー表示コンテナ）
    if (!Syntax_Checker.resultBox) {
      Syntax_Checker.resultBox = new ResultBox(Syntax_Checker.form);
    }

    // モックチェックオブジェクト作成（エラー表示用）
    var mockChecks = [{
      id: "html",
      name: "<%= t("modules.addons.cms/body_layout_html") %>"
    }];

    // エラーデータを設定
    Syntax_Checker.errors = <%= raw @syntax_checker.errors.to_json %>;

    // エラー表示メソッド呼び出し
    Syntax_Checker.resultBox.showResult(mockChecks, Syntax_Checker.errors);
  });
</script>
<% end %>
