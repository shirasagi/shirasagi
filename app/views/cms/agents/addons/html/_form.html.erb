<% if @syntax_checker && @syntax_checker.errors.present? %>
  <%= syntax_check_detail_box @syntax_checker %>
<% end %>

<%= code_editor ".mod-cms-html-form textarea", mode: :html %>

<dl class="see mod-cms-html-form">
  <dd class="wide"><%= f.text_area :html, style: "height: 400px" %></dd>
</dl>

<script>
  $(function() {
    // CodeMirrorの更新処理
    function updateCodeMirror(content) {
      var editor = $('.mod-cms-html-form textarea').data('codemirror');
      if (editor) {
        editor.setValue(content);
        editor.refresh();
      }
    }

    // 自動修正ボタンのクリックイベント
    $(document).on("click", ".btn-auto-correct", function(ev) {
      ev.preventDefault();
      var $btn = $(this);
      var $form = $btn.closest('form');
      // フォームに自動修正フラグを追加
      $form.append('<input type="hidden" name="auto_correct" value="1">');
      // フォームを送信
      $form.submit();
    });
  });
</script>
