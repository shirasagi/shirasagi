<%

categories = Opendata::Node::Category.site(@cur_site).sort(order: 1)
areas = Opendata::Node::Area.site(@cur_site).sort(order: 1)

%>
<%= coffee do %>
$ ->
  data = <%== @model.licenses.inspect %>

  $("#item_license").autocomplete
    source: (request, response) ->
      response(
        $.grep data, (value) ->
          return value.match(new RegExp("^" + request.term, "i"))
      )
<% end %>

<dl class="see opendata-dataset">
  <dt><%= @model.t :name %></dt>
  <dd><%= f.text_field :name %></dd>

  <dt><%= @model.t :license %></dt>
  <dd><%= f.text_field :license, style: "ime-mode: disabled;" %></dd>

  <dt><%= @model.t :text %></dt>
  <dd><%= f.text_area :text %></dd>

  <dt><%= @model.t :related_url %></dt>
  <dd><%= f.text_field :related_url %></dd>

  <dt><%= @model.t :category_ids %></dt>
  <dd>
    <%= f.hidden_field "category_ids[]", value: "" %>
    <% categories.each do |c| %>
      <label><%= f.check_box("category_ids[]", {}, c.id) %> <%= c.name %></label>
    <% end %>
  </dd>

  <dt><%= @model.t :area_ids %></dt>
  <dd><%= render partial: "opendata/agents/addons/area/view/form", locals: { f: f } %></dd>

  <dt><%= @model.t :tags %></dt>
  <dd><%= f.text_field :tags %></dd>
</dl>
