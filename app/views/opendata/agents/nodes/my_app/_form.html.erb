<%

categories = Opendata::Node::Category.site(@cur_site).sort(order: 1)
areas = Opendata::Node::Area.site(@cur_site).sort(order: 1)
licenses = Opendata::License.site(@cur_site).public.sort(order: 1).map { |c| [c.name, c.id] }

%>
<%= javascript_include_tag "opendata/public" %>
<%= javascript_include_tag "opendata/form" %>

<script language=javascript>
<!--
function show(inputData) {
var objID=document.getElementById( "layer_" + inputData );
var buttonID=document.getElementById( "category_" + inputData );
if(objID.className=='close') {
objID.style.display='block';
objID.className='open';
}else{
objID.style.display='none';
objID.className='close';
}
}
//-->
</script>

<dl class="see opendata-app">
  <dt><%= @model.t :name %><%= required_label %></dt>
  <dd><%= f.text_field :name %></dd>

  <dt><%= @model.t :text %><%= @item.tt :text %><%= required_label %></dt>
  <dd><%= f.text_area :text %></dd>

  <dt><%= @model.t :license_id %><%= required_label %></dt>
  <dd><%= f.select :license_id, licenses, include_blank: "" %></dd>

  <dt><%= @model.t :tags %><%= @item.tt :tags %></dt>
  <dd><%= f.text_field :tags %></dd>

  <dt><%= @model.t :appurl %></dt>
  <dd><%= f.url_field :appurl %></dd>

  <dt><%= @model.t :category_ids %><%= required_label %></dt>
  <dd>
    <%= f.hidden_field "category_ids[]", value: "" %>
    <% categories.each do |c| %>
      <label><%= f.check_box("category_ids[]", {}, c.id) %> <%= c.name %></label>
    <% end %>
  </dd>

  <dt><%= @model.t :area_ids %></dt>
  <dd><%= render partial: "opendata/agents/addons/area/view/form", locals: { f: f } %></dd>

  <dt><%= @model.t :dataset_ids %></dt>
  <dd>
  <a href="javascript:void(0)" id="category_dataset" onclick="show('dataset');">展開</a>
  <div id="layer_dataset" style="display: none;position:relative;margin-left:15pt" class="close">
  <%= render partial: "opendata/agents/addons/dataset/view/form", locals: { f: f } %></div>
  </dd>

  <dt><%= @model.t :state %></dt>
  <dd><%= f.select :state, @item.state_options %></dd>
</dl>
