<%
  return if @item.imap_setting.blank?

  default = t('webmail.default_settings')
  imap = Webmail::Imap::Base.new(@cur_user, @item.imap_setting)
  quota = imap.quota.load rescue nil
%>

<dl class="see">
  <dt><%= @model.t :imap_setting_name %></dt>
  <dd><%= @item.imap_setting.name %></dd>

  <dt><%= @model.t :from %></dt>
  <dd><%= @item.imap_setting.from.presence || @cur_user.name %></dd>

  <dt><%= @model.t :address %></dt>
  <dd><%= @item.imap_setting.address.presence || @contact_email || @cur_user.email %></dd>

  <dt><%= @model.t :imap_host %></dt>
  <dd><%= @item.imap_setting.imap_host.presence || default %></dd>

  <dt><%= @model.t :imap_port %></dt>
  <dd><%= @item.imap_setting.imap_port.presence || default %></dd>

  <dt><%= @model.t :imap_ssl_use %></dt>
  <dd>
    <% if @item.imap_setting.imap_ssl_use.present? %>
      <%= t("webmail.options.imap_ssl_use.#{@item.imap_setting.imap_ssl_use}") %>
    <% else %>
      <%= default %>
    <% end %>
  </dd>

  <dt><%= @model.t :imap_auth_type %></dt>
  <dd><%= @item.imap_setting.imap_auth_type.presence || default %></dd>

  <dt><%= @model.t :imap_account %></dt>
  <dd><%= @item.imap_setting.imap_account.presence || default %></dd>

  <dt><%= @model.t :imap_password %></dt>
  <dd><%= ('*' * @item.imap_setting.decrypt_imap_password.to_s.size).presence || default %></dd>

  <dt><%= @model.t :imap_sent_box %></dt>
  <dd><%= @item.imap_setting.imap_sent_box %></dd>

  <dt><%= @model.t :imap_draft_box %></dt>
  <dd><%= @item.imap_setting.imap_draft_box %></dd>

  <dt><%= @model.t :imap_account %></dt>
  <dd><%= @item.imap_setting.imap_trash_box %></dd>

  <% if @item.imap_setting.threshold_mb %>
  <dt><%= @model.t :threshold_mb %></dt>
  <dd><%= @item.imap_setting.threshold_mb %><%= t "ss.units.mega_byte" %></dd>
  <% end %>

  <% if quota %>
  <dt><%= t('mongoid.models.webmail/quota') %></dt>
  <dd style="width: 210px;">
    <div class="ss-quota-bar">
      <div class="label"><%= quota.label %></div>
      <div class="usage <%= quota.over_threshold? ? 'over-threshold' : '' %>" style="width: <%= quota.percentage %>%"></div>
    </div>
  </dd>
  <% end %>
</dl>
