(function(){$(window).load(function(){return window.load_cms_form?void 0:(window.load_cms_form=!0,Syntax_Checker.render(),Link_Checker.render(),Form_Alert.addValidation(Form_Alert.presence),Form_Alert.addValidation(Syntax_Checker.validateHtml),Form_Alert.render())}),this.Syntax_Checker=function(){function e(){}return e.message={notSetImgAlt:"\u753b\u50cf\u306e\u4ee3\u66ff\u30c6\u30ad\u30b9\u30c8\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",invalidImgScheme:"\u753b\u50cf\u306eURI\u306b\u30d0\u30a4\u30ca\u30ea\u30fc\u6587\u5b57\u5217\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002",notSetTableCaption:"\u8868\u306b\u30ad\u30e3\u30d7\u30b7\u30e7\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",notSetThScope:"\u8868\u306e\u30d8\u30c3\u30c0\u30fc\u306b\u30b9\u30b3\u30fc\u30d7\u5c5e\u6027\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",invalidOrderOfH:"\u898b\u51fa\u3057\u306e\u9806\u756a\u304c\u4e0d\u6b63\u3067\u3059\u3002",invalidMultibyteCharacter:"\u82f1\u6570\u5b57\u306f\u534a\u89d2\u6587\u5b57\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",invalidDependentCharacter:"\u6a5f\u7a2e\u4f9d\u5b58\u6587\u5b57\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002",invalidDateFormat:"\u65e5\u4ed8\u306e\u8868\u8a18\u306f\u25cb\u5e74\u25cb\u6708\u25cb\u65e5\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002",invalidAdjacentA:"\u96a3\u63a5\u3059\u308b\u540c\u3058\u30ea\u30f3\u30af\u3092\u4e00\u3064\u306e\u30ea\u30f3\u30af\u306b\u307e\u3068\u3081\u3066\u304f\u3060\u3055\u3044\u3002",checkInterwordSpace:"\u5358\u8a9e\u306e\u6587\u5b57\u9593\u306e\u30b9\u30da\u30fc\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",checkLinkText:"\u30ea\u30f3\u30af\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",checkEmbeddedMedia:"\u52d5\u753b\u3084\u97f3\u58f0\u3092\u542b\u3080\u5834\u5408\u3001\u8aac\u660e\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},e.detail={notSetImgAlt:["\u753b\u50cf\u306e\u5185\u5bb9\u3092\u793a\u3059\u4ee3\u66ff\u30c6\u30ad\u30b9\u30c8\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidImgScheme:["\u753b\u50cf\u306eSRC\u5c5e\u6027\u306b\u30c7\u30fc\u30bf\u5f62\u5f0f\u306eURI\u30b9\u30ad\u30fc\u30e0\u304c\u5b58\u5728\u3057\u307e\u3059\u3002","\u4ed6\u306eURI\u30b9\u30ad\u30fc\u30e0\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],notSetTableCaption:["\u8868\u306b\u898b\u51fa\u3057(CAPTION)\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093","TABLE\u30bf\u30b0\u306e\u4e2d\u306bCAPTION\u30bf\u30b0\u3092\u8ffd\u8a18\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],notSetThScope:["\u8868\u306e\u30d8\u30c3\u30c0\u30fc(TH)\u306b\u898b\u51fa\u3057\u306e\u65b9\u5411\u3067\u3042\u308bSCOPE\u5c5e\u6027\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",'\u884c\u65b9\u5411\u3067\u3042\u308c\u3070scope="col\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002','\u5217\u65b9\u5411\u3067\u3042\u308c\u3070scope="row"\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002'],invalidOrderOfH:["\u898b\u51fa\u3057(H)\u306e\u9806\u756a\u304c\u4e0d\u6b63\u3067\u3059\u3002","\u9069\u5207\u306a\u9806\u306b\u914d\u7f6e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidMultibyteCharacter:["\u672c\u6587\u306b\u5168\u89d2\u82f1\u6570\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002","\u534a\u89d2\u82f1\u6570\u306b\u7f6e\u304d\u63db\u3048\u308b\u304b\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidDependentCharacter:["\u672c\u6587\u306b\u6a5f\u7a2e\u4f9d\u5b58\u6587\u5b57\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002","\u4ed6\u306e\u6587\u5b57\u306b\u7f6e\u304d\u63db\u3048\u308b\u304b\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidDateFormat:["\u65e5\u4ed8\u306e\u5f62\u5f0f\u3092\u4fee\u6b63\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidAdjacentA:["\u96a3\u308a\u5408\u3046\u30ea\u30f3\u30af(A)\u306b\u540c\u3058\u30ea\u30f3\u30af\u5148\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002","\u4e00\u3064\u306e\u30ea\u30f3\u30af(A)\u306b\u30de\u30fc\u30af\u30a2\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],checkInterwordSpace:["\u5358\u8a9e\u306e\u6587\u5b57\u9593\u306b\u4e0d\u8981\u306a\u30b9\u30da\u30fc\u30b9\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],checkLinkText:["\u30ea\u30f3\u30af\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u306f\u9077\u79fb\u5148\u3092\u8868\u3059\u3082\u306e\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],checkEmbeddedMedia:["\u52d5\u753b\u3084\u97f3\u58f0\u3092\u672c\u6587\u306b\u57cb\u3081\u8fbc\u3080\u5834\u5408\u306f\u8aac\u660e\u3092\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]},e.dependentCharacter="\u2460\u2461\u2462\u2463\u2464\u2465\u2466\u2467\u2468\u2469\u246a\u246b\u246c\u246d\u246e\u246f\u2470\u2471\u2472\u2473\u2160\u2161\u2162\u2163\u2164\u2165\u2166\u2167\u2168\u2169\u3349\u3314\u3322\u334d\u3318\u3327\u3303\u3336\u3351\u3357\u330d\u3326\u3323\u332b\u334a\u333b\u339c\u339d\u339e\u338e\u338f\u33c4\u33a1\u337b\u301d\u301f\u2116\u33cd\u2121\u32a4\u32a5\u32a6\u32a7\u32a8\u3231\u3232\u3239\u337e\u337d\u337c\u337b\xa9\xae\u3237\u3230\u322a\u322b\u322c\u322d\u322e\u322f\u3297\u3290\u328a\u328b\u328c\u328d\u328e\u328f\u32c0\u32c1\u32c2\u32c3\u32c4\u32c5\u32c6\u32c7\u32c8\u32c9\u32ca\u32cb\u33e0\u33e1\u33e2\u33e3\u33e4\u33e5\u33e6\u33e7\u33e8\u33e9\u33ea\u33eb\u33ec\u33ed\u33ee\u33ef\u33f0\u33f1\u33f2\u33f3\u33f4\u33f5\u33f6\u33f7\u33f8\u33f9\u33fa\u33fb\u33fc\u33fd\u33fe\u2194\u2195\u2196\u2197\u2198\u2199\u21d2\u21d4\u21d0\u21d1\u21d3\u21d5\u21d6\u21d7\u21d8\u21d9\u32d0\u32d1\u32d2\u32d3\u32d4\u32d5\u32d6\u32d7\u32d8\u32d9\u3291\u3292\u3293\u3294\u3295\u329f\u329a\u329b\u329c\u32a3\u32a1\u32a2\u32ab\u32ac\u32ad\u32ae\u32af\u32b0\u329e\u3296\u32a9\u329d\u3298\u3299\u32aa\u3233\u3234\u3235\u3236\u3238\u323a\u323b\u323c\u323d\u323e\u323f\u25ba\u263a\u25c4\u263b\u203c\u3380\u3381\u3382\u3383\u3384\u3388\u3389\u338a\u338b\u338c\u338d\u3391\u3392\u3393\u2170\u2171\u2172\u2173\u2174\u2175\u2176\u2177\u2178\u2179\u3020\u2660\u2663\u2665\u2664\u2667\u2661\uffe4\uff07",e.mediaExtension=["aac","aif","aiff","au","avi","flac","flv","mid","midi","mp3","m4a","mp4","mpg","mpeg","oga","ogg","tta","vdo","wav","wma","wmv"],e.errors,e.errorCount,e.reset=function(){this.errors={},this.errorCount=0},e.render=function(){return $(".mod-cms-body button.syntax-check").on("click",function(){return e.check()})},e.check=function(t){var r,n,a;return null==t&&(t={}),e.reset(),r=e.getEditorHtml(),e.checkTable(r),e.checkMultibyteCharacter(r),e.checkDependentCharacter(r),e.checkDateFormat(r),e.checkAdjacentA(r),e.checkOrderOfH(r),e.checkImgAlt(r),e.checkImgDataUriScheme(r),e.checkInterwordSpace(r),e.checkLinkText(r),e.checkEmbeddedMedia(r),$(".mod-cms-body div#errorSyntaxChecker").remove(),n=$("<div>"),n.attr("id","errorSyntaxChecker"),n.attr("class","errorExplanation"),n.append("<h2>HTML\u30c1\u30a7\u30c3\u30af</h2>"),Object.keys(e.errors).length?(n.append("<p>\u6b21\u306e\u9805\u76ee\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"),n.append("<ul>"),a=n.find("ul:last"),e.appendMessage(a,e.errors),$(".mod-cms-body dd:last").after(n),SS_Tooltips.render(".detail"),!1):(n.append("<p>\u30a8\u30e9\u30fc\u306f\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002</p>"),$(".mod-cms-body dd:last").after(n),!0)},e.validateHtml=function(){var t,r,n,a,i,c,o;if(!e.check()){t="HTML\u30c1\u30a7\u30c3\u30af",c=e.errors,o=[];for(i in c)n=c[i],o.push(function(){var e,i,c;for(c=[],a=e=0,i=n.length;i>e;a=++e)r=n[a],c.push(Form_Alert.add(t,this,r.msg));return c}.call(this));return o}},e.getEditorHtml=function(){var e;return e="undefined"!=typeof tinymce?"<div>"+tinymce.get("item_html").getContent()+"</div>":"undefined"!=typeof CKEDITOR?"<div>"+CKEDITOR.instances.item_html.getData()+"</div>":""},e.setEditorHtml=function(e){return"undefined"!=typeof tinymce?tinymce.get("item_html").setContent(e):"undefined"!=typeof CKEDITOR?CKEDITOR.instances.item_html.setData(e):void 0},e.pushError=function(t){var r;return r=e.errorCount,e.errors[r]=t,e.errorCount+=1,r},e.isValidDate=function(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())&&e.getYear()>0?!0:!1},e.justText=function(e){return $(e).clone().children().remove().end().text()},e.outerHtmlSummary=function(e){return $(e).get(0).outerHTML.replace(/[\r\n]|&nbsp;/g,"")},e.appendMessage=function(t,r){var n,a,i,c,o,d,s,l,h;h=[];for(d in r)c=r[d],t.append('<li class="code">'),t.find("li:last").append("<code>"),t.append("<ul>"),h.push(function(){var r,d,h;for(h=[],o=r=0,d=c.length;d>r;o=++r)i=c[o],t.find("li:last code").text(i.code),t.find("> ul:last").append("<li>"),s=t.find("> ul:last li:last"),l=$('<span class="message detail">'+i.msg+"</span>"),i.detail&&(a=$("<ul>").appendTo(l),$.each(i.detail,function(){return a.append("<li>"+this+"</li>"),a.hide()})),s.append(l),i.correct&&i.ele?(n=$('<a href="#" class="correct">\u81ea\u52d5\u4fee\u6b63</a>'),n.on("click",{error:i},function(t){var r;return r=t.data.error.correct(t.data.error.ele),console.log(r),e.setEditorHtml(r),$(".mod-cms-body button.syntax-check").trigger("click"),!1}),h.push(s.append(n))):h.push(void 0);return h}());return h},e.checkImgAlt=function(t){return $(t).find("img").each(function(){var t,r;return t=$(this).attr("alt"),!t||""===t.trim()||/^[\w\s\.\-]*$/.test(t)?(r=[{code:e.outerHtmlSummary(this),msg:e.message.notSetImgAlt,detail:e.detail.notSetImgAlt,ele:this}],e.pushError(r)):void 0})},e.checkImgDataUriScheme=function(t){return $(t).find("img[src]").each(function(){var t,r;return r=$(this).attr("src"),/^data:.*?,.*?$/.test(r)?(t=[{code:e.outerHtmlSummary(this),msg:e.message.invalidImgScheme,detail:e.detail.invalidImgScheme,ele:this}],e.pushError(t)):void 0})},e.checkTable=function(t){return $(t).find("table").each(function(){var t,r,n;return n=this,t=$(this).find("caption"),r=[],t&&""!==t.text().trim()||r.push({code:e.outerHtmlSummary(n),msg:e.message.notSetTableCaption,detail:e.detail.notSetTableCaption,ele:n,correct:e.correctTableCaption}),$(n).find("th").each(function(){return $(this).attr("scope")?void 0:(r.push({code:e.outerHtmlSummary(n),msg:e.message.notSetThScope,detail:e.detail.notSetThScope,ele:n,correct:e.correctTableScope}),!1)}),$.isEmptyObject(r)?void 0:e.pushError(r)})},e.correctTableCaption=function(e){return $(e).find("caption").remove(),$(e).prepend("<caption>\u30ad\u30e3\u30d7\u30b7\u30e7\u30f3</caption>"),$(e).parents().last().html()},e.correctTableScope=function(e){var t;return t=1===$(e).find("tr:first th").length?"row":"col",$(e).find("tr:first th").each(function(){return $(this).attr("scope")?void 0:$(this).attr("scope",t)}),$(e).find("tr:not(:first) th").each(function(){return $(this).attr("scope")?void 0:$(this).attr("scope","row")}),$(e).parents().last().html()},e.checkOrderOfH=function(t){var r,n,a,i,c,o;if(a=$(t).find("h1,h2,h3,h4,h5,h6"),a.length){for(r="",i=c=0,o=a.length-1;o>=0?o>=c:c>=o;i=o>=0?++c:--c)0===i?/h[12]/i.test(a[i].tagName)||(r+=a[i].tagName+" "):/h3/i.test(a[i].tagName)?/h[23456]/i.test(a[i-1].tagName)||(r+=a[i].tagName+" "):/h4/i.test(a[i].tagName)?/h[3456]/i.test(a[i-1].tagName)||(r+=a[i].tagName+" "):/h5/i.test(a[i].tagName)?/h[456]/i.test(a[i-1].tagName)||(r+=a[i].tagName+" "):/h6/i.test(a[i].tagName)&&(/h[56]/i.test(a[i-1].tagName)||(r+=a[i].tagName+" "));""!==r&&(n=[{code:r,msg:e.message.invalidOrderOfH,ele:t,detail:e.detail.invalidOrderOfH,correct:e.correctOrderOfH}],e.pushError(n))}},e.correctOrderOfH=function(e){var t,r,n,a,i;if(t=$(e).find("h1,h2,h3,h4,h5,h6"),!t.length)return $(e).parents().last().html();for(n=e,r=a=0,i=t.length-1;i>=0?i>=a:a>=i;r=i>=0?++a:--a)0===r?/h[12]/i.test(t[r].tagName)||(n=$("<h1>"+$(t[r]).html()+"</h1>"),$(t[r]).after(n).remove(),t[r]=n[0]):/h3/i.test(t[r].tagName)?/h[23456]/i.test(t[r-1].tagName)||(n=$("<"+t[r-1].tagName.replace("1","2")+">"),n.html($(t[r]).html()),$(t[r]).after(n).remove(),t[r]=n[0]):/h4/i.test(t[r].tagName)?/h[3456]/i.test(t[r-1].tagName)||(n=$("<"+t[r-1].tagName.replace("1","2")+">"),n.html($(t[r]).html()),$(t[r]).after(n).remove(),t[r]=n[0]):/h5/i.test(t[r].tagName)?/h[456]/i.test(t[r-1].tagName)||(n=$("<"+t[r-1].tagName.replace("1","2")+">"),n.html($(t[r]).html()),$(t[r]).after(n).remove(),t[r]=n[0]):/h6/i.test(t[r].tagName)&&(/h[56]/i.test(t[r-1].tagName)||(n=$("<"+t[r-1].tagName.replace("1","2")+">"),n.html($(t[r]).html()),$(t[r]).after(n).remove(),t[r]=n[0]));return $(n).parents().last().html()},e.checkMultibyteCharacter=function(t){var r,n;return r=t.match(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g),$.isEmptyObject(r)?void 0:(n=[{code:r.join(","),msg:e.message.invalidMultibyteCharacter,detail:e.detail.invalidMultibyteCharacter,ele:t,correct:e.correctMultibyteCharacter}],e.pushError(n))},e.correctMultibyteCharacter=function(e){return e=e.replace(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)}),$(e).html()},e.checkDependentCharacter=function(t){var r,n,a;return a=new RegExp("["+e.dependentCharacter+"]","g"),r=t.match(a),$.isEmptyObject(r)?void 0:(n=[{code:r.join(","),msg:e.message.invalidDependentCharacter,detail:e.detail.invalidDependentCharacter,ele:t,correct:e.correctDependentCharacter}],e.pushError(n))},e.correctDependentCharacter=function(t){var r;return r=new RegExp("["+e.dependentCharacter+"]","g"),t=t.replace(r,function(){return"[\u6a5f\u7a2e\u4f9d\u5b58\u6587\u5b57]"}),$(t).html()},e.checkDateFormat=function(t){var r,n;return(r=t.match(/[^\d-]\d{4}[ \\u3000\.\-\/]\d{1,2}[ \\u3000\.\-\/]\d{1,2}[^\d-]/g))?(r=$.map(r,function(e){return e.substr(1,e.length-2)}),r=$.grep(r,function(t){return e.isValidDate(new Date(t))}),$.isEmptyObject(r)?void 0:(n=[{code:r.join(","),msg:e.message.invalidDateFormat,detail:e.detail.invalidDateFormat,ele:t,correct:e.correctDateFormat}],e.pushError(n))):void 0},e.correctDateFormat=function(t){return t=t.replace(/([^\d-])(\d{4})[ \\u3000\.\-\/](\d{1,2})[ \\u3000\.\-\/](\d{1,2})([^\d-])/g,function(t,r,n,a,i,c){return e.isValidDate(new Date([n,a,i].join(" ")))?r+n+"\u5e74"+a+"\u6708"+i+"\u65e5"+c:t}),$(t).html()},e.checkAdjacentA=function(t){return $(t).find("a[href]").each(function(){var t,r;return r=$(this).next('a[href="'+$(this).attr("href")+'"]'),r.length?(t=[{code:e.outerHtmlSummary(this)+e.outerHtmlSummary(r),msg:e.message.invalidAdjacentA,detail:e.detail.invalidAdjacentA,ele:this,correct:e.correctAdjacentA}],e.pushError(t)):void 0})},e.correctAdjacentA=function(e){var t;return t=$(e).next('a[href="'+$(e).attr("href")+'"]'),$(e).html()!==$(t).html()&&$(e).html($(e).html()+$(t).html()),t.remove(),$(e).parents().last().html()},e.checkInterwordSpace=function(t){return $(t).find(":not(iframe)").each(function(){var t,r,n,a,i,c;if(n=$.trim(e.justText(this)),/[\u3000]/.test(n)){for(c=[],r=a=0,i=n.length-1;i>=0?i>=a:a>=i;r=i>=0?++a:--a){if(n.charCodeAt(r)>=256){t=[{code:n,msg:e.message.checkInterwordSpace,detail:e.detail.checkInterwordSpace}],e.pushError(t);break}c.push(void 0)}return c}})},e.checkLinkText=function(t){return $(t).find("a[href]").each(function(){var t,r;return r=$(this).text(),r.length<=3?(t=[{code:e.outerHtmlSummary(this),msg:e.message.checkLinkText,detail:e.detail.checkLinkText}],e.pushError(t)):void 0})},e.checkEmbeddedMedia=function(t){var r,n;return $(t).find("embed,video").each(function(){var t;return t=[{code:this,msg:e.message.checkEmbeddedMedia,detail:e.detail.checkEmbeddedMedia}],e.pushError(t)}),r=new RegExp("("+e.mediaExtension.join("|")+")","i"),n=/https?:\/\/www\.youtube\.com\//,$(t).find("iframe[src]").each(function(){var t,a,i;return i=$(this).attr("src"),a=i.replace(/\?.*$/,"").replace(/.*\//,"").split(".").pop(),r.test(a)||n.test(i)?(t=[{code:e.outerHtmlSummary(this),msg:e.message.checkEmbeddedMedia,detail:e.detail.checkEmbeddedMedia}],e.pushError(t)):void 0}),$(t).find("a[href]").each(function(){var t,a,i;return i=$(this).attr("href"),a=i.replace(/\?.*$/,"").replace(/.*\//,"").split(".").pop(),r.test(a)||n.test(i)?(t=[{code:e.outerHtmlSummary(this),msg:e.message.checkEmbeddedMedia,detail:e.detail.checkEmbeddedMedia}],e.pushError(t)):void 0})},e}(),this.Link_Checker=function(){function e(){}return e.message={header:"\u30ea\u30f3\u30af\u30c1\u30a7\u30c3\u30af",noLinks:"\u30ea\u30f3\u30af\u306f\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002",checkLinks:"\u6b21\u306e\u30ea\u30f3\u30af\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002",success:"\u6210\u529f",failure:"\u5931\u6557",linkCheckerError:"\u30ea\u30f3\u30af\u30c1\u30a7\u30c3\u30af\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6b21\u306eURL\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093\u3002"},e.links={},e.error="",e.url="/.cms/link_check/check.json",e.render=function(){return $(".mod-cms-body button.link-check").on("click",function(){var t,r;$.support.cors=!0,t=this,$(t).attr("disabled",!0),e.reset(),r="undefined"!=typeof tinymce?"<div>"+tinymce.get("item_html").getContent()+"</div>":"undefined"!=typeof CKEDITOR?"<div>"+CKEDITOR.instances.item_html.getData()+"</div>":"<div></div>",e.check(r,function(){var r,n,a,i,c;if(a=$("<div>"),a.attr("id","errorLinkChecker"),a.attr("class","errorExplanation"),a.append("<h2>"+e.message.header+"</h2>"),""!==e.error)a.append(e.error);else{a.append("<p>"+e.message.checkLinks+"</p>"),a.append("<ul>"),i=a.find("ul"),c=e.links;for(r in c)n=c[r],i.append("<li>"),i.find("li:last").append(n)}$(".mod-cms-body div#errorLinkChecker").remove(),$(".mod-cms-body").append(a),$(t).removeAttr("disabled")})})},e.reset=function(){this.links={},this.error=""},e.check=function(t,r){var n,a,i,c,o,d,s;if(c=$(t).find("a[href]").length,0===c)return e.error="<p>"+e.message.noLinks+"</p>",void r();for(i={},s=$(t).find("a[href]"),a=o=0,d=s.length;d>o;a=++o)n=s[a],i[a+1]=$(n).attr("href");$.ajax({type:"POST",url:e.url,cache:!1,data:JSON.stringify({url:i}),contentType:"application/json",dataType:"json",crossDomain:!0,success:function(t){var r,n,a;for(n in t)r=t[n],200===r?(a='<span class="success">'+e.message.success+"</span>",e.links[n]=n+" "+a):(a='<span class="failure">'+e.message.failure+"</span>",e.links[n]=n+" "+a)},error:function(){e.error="<p>"+e.message.linkCheckerError+": "+e.url+"</p>"},complete:function(){r()}})},e}(),this.Form_Alert=function(){function e(){}return e.alerts=[],e.validations=[],e.render=function(){return $("input:submit").on("click.submit_alert",function(){var t,r,n,a,i,c,o,d,s,l,h,m;if(d=this,c=$(d).closest("form"),!e.validate(c)){r=$('<div id="alertExplanation" class="errorExplanation">'),r.append("<h2>\u8b66\u544a</h2>"),m=e.alerts;for(t in m)for(a=m[t],r.append("<p>"+t+"</p>"),s=$("<ul>").appendTo(r),o=l=0,h=a.length;h>l;o=++l)n=a[o],s.append("<li>"+n.msg+"</li>");return i=$('<footer class="send">'),i.append('<button name="button" type="button" class="save">\u8b66\u544a\u3092\u7121\u8996\u3059\u308b</button>'),i.append('<button name="button" type="button" class="cancel">\u30ad\u30e3\u30f3\u30bb\u30eb</button>'),$.colorbox({html:r.get(0).outerHTML+i.get(0).outerHTML,fixed:!0}),$("#cboxLoadedContent").find(".save").on("click",{submit:d},function(){return $(d).off(".submit_alert"),$(d).trigger("click")}),$("#cboxLoadedContent").find(".cancel").on("click",function(){return $.colorbox.close(),!1}),!1}})},e.validate=function(t){return e.alerts={},$.each(e.validations,function(){return this(t)}),$.isEmptyObject(e.alerts)?ture:!1},e.addValidation=function(t){return e.validations.push(t)},e.presence=function(t){return $(t).find("input.presence,textarea.presence").each(function(){var t,r;return""===$(this).val()?($(this).closest("dl").show(),t=$(this).closest(".addon-view").find("header").text(),r=e.justText($(this).closest("dd").prev("dt")),e.add(t,this,r+"\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):void 0})},e.add=function(t,r,n){var a;return(a=e.alerts)[t]||(a[t]=[]),e.alerts[t].push({ele:r,msg:n})},e.justText=function(e){return $(e).clone().children().remove().end().text()},e}()}).call(this);