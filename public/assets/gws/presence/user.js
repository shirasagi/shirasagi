this.Gws_Presence_User=function(){function l(){}return l.render=function(){$(document).on("click",function(){return $(".presence-state-selector").hide(),!0}),$(".presence-state-selector").on("click",function(){return!1}),$(".presence-state-selector [data-value]").on("click",function(){var e=$(this).closest(".presence-state-selector").attr("data-id"),t=$(this).closest(".presence-state-selector").attr("data-url"),a=$(this).attr("data-value");return $.ajax({url:t,type:"POST",data:{_method:"put",authenticity_token:$('meta[name="csrf-token"]').attr("content"),presence_state:a},success:function(t){l.changedState(e,t),$(".presence-state-selector").hide()},error:function(t){alert(t.responseJSON.join("\n"))}}),!1}),$(".editable .select-presence-state,.editable .presence-state").on("click",function(){return $(".presence-state-selector").closest("li.portlet-item").css("z-index",0),$(".presence-state-selector").hide(),$(this).closest("li.portlet-item").css("z-index",1e3),$(this).closest("td").find(".presence-state-selector").show(),!1}),$(".ajax-text-field").on("click",function(){return l.toggleForm(this),!1}),$(".ajax-text-field").next(".editicon").on("click",function(){return $(this).prev(".ajax-text-field").trigger("click"),!1})},l.changedState=function(t,e){var a=e.presence_state||"",r=e.presence_state_label,n=e.presence_state_style,s=$("tr[data-id="+t+"] .presence-state"),i=$("tr[data-id="+t+"] .presence-state-selector");s.removeClass(),s.addClass("presence-state"),s.addClass(n),s.text(r),i.find('[data-value="'+a+'"] .selected-icon').css("visibility","visible"),i.find('[data-value!="'+a+'"] .selected-icon').css("visibility","hidden")},l.toggleForm=function(t){var e=$(t).attr("data-tag-state"),a=$(t).attr("data-original-tag"),r=$(t).attr("data-form-tag"),n=$(t).text()||$(t).val(),s=$(r).attr("name"),i=($(r).attr("data-id"),$(r).attr("data-url")),o=!1;if("original"==e){(r=$(r)).attr("data-original-tag",$(t).attr("data-original-tag")),r.attr("data-form-tag",$(t).attr("data-form-tag")),r.val(n),r.focusout(function(){if(o)return!0;var t={_method:"put",authenticity_token:$('meta[name="csrf-token"]').attr("content")};return t[s]=$(r).val(),$.ajax({url:i,type:"POST",data:t,success:function(t){$(r).val(t[s]),l.toggleForm(r)},error:function(t){alert(t.responseJSON.join("\n")),o=!0}}),!1}),r.keypress(function(t){if(13==t.which){var e={_method:"put",authenticity_token:$('meta[name="csrf-token"]').attr("content")};return e[s]=$(r).val(),$.ajax({url:i,type:"POST",data:e,success:function(t){$(r).val(t[s]),l.toggleForm(r)},error:function(t){alert(t.responseJSON.join("\n")),o=!0}}),!1}});var c=r.uniqueId();$(t).replaceWith(r),$(c).focus()}else(a=$(a).text(n)).attr("data-original-tag",$(t).attr("data-original-tag")),a.attr("data-form-tag",$(t).attr("data-form-tag")),a.on("click",function(){return l.toggleForm(this),!1}),a.uniqueId(),$(t).replaceWith(a),$(".ajax-text-field[data-id='"+a.attr("data-id")+"'][data-name='"+a.attr("data-name")+"']").text(n)},l}(),this.Gws_Presence_User_Reload=function(){function t(){}return t.render=function(t){null==t&&(t={});var e=t.url,a=t.paginate_params,r=t.page;$(".group-users .reload").on("click",function(){param=$.param({s:{keyword:$(".group-users [name='s[keyword]']").val()},paginate_params:a,page:r}),$.ajax({url:e+"?"+param,beforeSend:function(){$(".group-users .data-table-wrap").html(SS.loading)},success:function(t){$(".group-users .data-table-wrap").html(t);var e=$(".group-users .data-table-wrap").find("time");$(".group-users .list-head time").replaceWith(e).show(),e.show()}})}),$(".group-users .list-head .search").on("submit",function(){return param=$.param({s:{keyword:$(".group-users [name='s[keyword]']").val()},paginate_params:a}),$.ajax({url:e+"?"+param,beforeSend:function(){$(".group-users .data-table-wrap").html(SS.loading)},success:function(t){$(".group-users .data-table-wrap").html(t);var e=$(".group-users .data-table-wrap").find("time");$(".group-users .list-head time").replaceWith(e),e.show()},error:function(){$(".group-users .data-table-wrap").html("")}}),!1})},t}();