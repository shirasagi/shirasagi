(function(){this.Member_Photo_Form=function(){function t(){}return t.maxPointForm=10,t.deleteMessage="\u30de\u30fc\u30ab\u30fc\u3092\u524a\u9664\u3057\u3066\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",t.setExifMessage="\u753b\u50cf\u306b\u4f4d\u7f6e\u60c5\u5831\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\u4f4d\u7f6e\u60c5\u5831\u3092\u5730\u56f3\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u304b\uff1f",t.dataID=0,t.clickIcon="//maps.google.com/mapfiles/ms/icons/blue-dot.png",t.clickMarker=null,t.setMapLoc=function(t,e,i){e=Math.ceil(e*Math.pow(10,6))/Math.pow(10,6),i=Math.ceil(i*Math.pow(10,6))/Math.pow(10,6),t.val(e.toFixed(6)+","+i.toFixed(6))},t.getMapLoc=function(t){var e;return e=t.val().split(","),new google.maps.LatLng(parseFloat(e[0]),parseFloat(e[1]))},t.attachMessage=function(t){google.maps.event.addListener(Googlemaps_Map.markers[t],"click",function(e){Googlemaps_Map.openedInfo&&Googlemaps_Map.openedInfo.close(),$('dd[data-id = "'+t+'"]').each(function(){var e,i,o;return i=$(this).find(".marker-name").val(),o=$(this).find(".marker-text").val(),(""!==i||""!==o)&&(e='<div class="marker-info">',""!==i&&(e+="<p>"+i+"</p>"),""!==o&&$.each(o.split(/[\r\n]+/),function(){return e+=this.match(/^https?:\/\//)?'<p><a href="'+this+'">'+this+"</a></p>":"<p>"+this+"</p>"}),Googlemaps_Map.openedInfo=new google.maps.InfoWindow({content:e,maxWidth:260}),Googlemaps_Map.openedInfo.open(Googlemaps_Map.markers[t].getMap(),Googlemaps_Map.markers[t])),!1})})},t.clearMarker=function(e){var i;i=0,""!==e.val()?confirm(t.deleteMessage)&&Googlemaps_Map.markers[i]&&(Googlemaps_Map.markers[i].setMap(null),e.val("")):Googlemaps_Map.markers[i]&&Googlemaps_Map.markers[i].setMap(null)},t.createMarker=function(e){var i;""!==$(".mod-map .clicked").val()&&(e.val($(".mod-map .clicked").val()),i=0,Googlemaps_Map.markers[i]&&Googlemaps_Map.markers[i].setMap(null),Googlemaps_Map.markers[i]=new google.maps.Marker({position:t.getMapLoc($(".mod-map .marker-loc")),map:Googlemaps_Map.map}),t.attachMessage(i))},t.renderMarkers=function(){var e,i,o,r,n,s;if(r=new google.maps.LatLngBounds,Googlemaps_Map.markers)for(n=Googlemaps_Map.markers,e=0,i=n.length;i>e;e++)o=n[e],o.setMap(null);Googlemaps_Map.markers=[],t.dataID=0,$(".mod-map .marker").each(function(){var e;return $(this).attr("data-id",t.dataID),""!==$(this).find(".marker-loc").val()&&(e=t.getMapLoc($(this).find(".marker-loc")),Googlemaps_Map.markers[t.dataID]=new google.maps.Marker({position:e,map:Googlemaps_Map.map}),t.attachMessage(t.dataID),r.extend(e)),t.dataID+=1}),Googlemaps_Map.markers.length>0&&(s=google.maps.event.addListener(Googlemaps_Map.map,"bounds_changed",function(t){return this.getZoom()>13&&this.initialZoom===!0&&(this.setZoom(13),this.initialZoom=!1),google.maps.event.removeListener(s)}),Googlemaps_Map.map.initialZoom=!0,Googlemaps_Map.map.fitBounds(r))},t.setExifLatLng=function(e){return $(e).change(function(e){return e.target.files[0]?EXIF.getData(e.target.files[0],function(){var e,i,o,r;return e=EXIF.getTag(this,"GPSLatitude"),o=EXIF.getTag(this,"GPSLongitude"),i=EXIF.getTag(this,"GPSLatitudeRef")||"N",r=EXIF.getTag(this,"GPSLongitudeRef")||"W",e&&o&&confirm(t.setExifMessage)?(i="N"===i?1:-1,r="W"===r?-1:1,e=(e[0]+e[1]/60+e[2]/3600)*i,o=(o[0]+o[1]/60+o[2]/3600)*r,$(".mod-map .clicked").val([e,o].join()),t.createMarker($(".mod-map .marker-loc")),Googlemaps_Map.map.setCenter(new google.maps.LatLng(e,o))):!1}):void 0})},t.renderEvents=function(){return google.maps.event.addListener(Googlemaps_Map.map,"click",function(e){return t.setMapLoc($(".mod-map .clicked"),e.latLng.lat(),e.latLng.lng()),t.createMarker($(".mod-map .marker-loc"))}),$(".mod-map .clear-marker").on("click",function(e){return t.clearMarker($(".mod-map .marker-loc")),!1})},t}()}).call(this);