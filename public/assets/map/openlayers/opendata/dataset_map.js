this.Openlayers_Dataset_Map=function(){function i(){}return i.map=null,i.map_points=null,i.render=function(e,t){$(".dataset-search a#ajax-search").colorbox({fixed:!0,width:"90%",height:"90%"});var a=$(e)[0];i.map=new Openlayers_Map(a,t)},i.selectItem=function(e){var t=$(e).attr("data-id"),a=$(e).find(".selected-item").clone(!1);$(a).find("a").removeClass("cboxElement"),$(a).find('[name="resource_id"]').each(function(){var e=$(this).val();$(this).data("map_points",i.map_points[t][e]),$(this).on("click",function(){i.map.removeMarkers(),$(".dataset-search .selected-item .set-markers:checked").each(function(){var e=$(this).data("map_points");i.map.renderMarkers(e),i.map.resize()})})}),$(a).find(".deselect").on("click",function(){return $(this).closest(".selected-item").remove(),i.map.removeMarkers(),$(".selected-item .set-markers:checked").each(function(){var e=$(this).data("map_points");i.map.renderMarkers(e),i.map.resize()}),!1}),a.show(),$(".dataset-search .selected-dataset").append(a);for(var s=$(".dataset-search .selected-dataset .selected-item").length-10,c=0;c<s;c++)$(".dataset-search .selected-dataset .selected-item:first").remove();return a},i.toggleSelectButton=function(){0<$(".search-ui .items input:checked").size()?$(".select-items").parent("div").show():$(".select-items").parent("div").hide()},i.modal=function(e){i.map_points=e,$(".search-ui-form form.search").on("submit",function(){return $(this).ajaxSubmit({url:$(this).attr("action"),success:function(e){return $("#cboxLoadedContent").html(e)},error:function(){return alert("== Error ==")}}),!1}),$(".search-ui a.select-item").on("click",function(){var e=$(this).closest("tr");return article=i.selectItem(e),$.colorbox.close(),$(article).find(".set-markers").trigger("click"),!1}),$(".search-ui-select .select-items").on("click",function(){return $(".search-ui .items .set-dataset:checked").each(function(){var e=$(this).closest("tr");i.selectItem(e)}),$.colorbox.close(),!1}),$(".search-ui .list-head input:checkbox").on("change",function(){var e=$(this).prop("checked");$(".search-ui .list-item").each(function(){$(this).toggleClass("checked",e),$(this).find(".set-dataset").prop("checked",e)})}),$(".search-ui").on("change",function(){i.toggleSelectButton()}),$(".dataset-search .selected-dataset .selected-item").each(function(){var e=$(this).attr("data-id"),t=$(".items [data-id='"+e+"']");t.find("input[type=checkbox]").remove();var a=t.find(".select-item").html();t.find(".select-item").replaceWith("<span class='select-item' style='color: #888'>"+a+"</span>")})},i}();