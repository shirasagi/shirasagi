{
  "scan_info": {
    "app_path": "/Users/tsukudasayoko/Desktop/dev/shirasagi",
    "rails_version": "8.0.2",
    "security_warnings": 62,
    "start_time": "2025-07-16 11:19:02 +0900",
    "end_time": "2025-07-16 11:19:42 +0900",
    "duration": 39.952508,
    "checks_performed": [
      "BasicAuth",
      "BasicAuthTimingAttack",
      "CSRFTokenForgeryCVE",
      "ContentTag",
      "CookieSerialization",
      "CreateWith",
      "CrossSiteScripting",
      "DefaultRoutes",
      "Deserialize",
      "DetailedExceptions",
      "DigestDoS",
      "DivideByZero",
      "DynamicFinders",
      "EOLRails",
      "EOLRuby",
      "EscapeFunction",
      "Evaluation",
      "Execute",
      "FileAccess",
      "FileDisclosure",
      "FilterSkipping",
      "ForceSSL",
      "ForgerySetting",
      "HeaderDoS",
      "I18nXSS",
      "JRubyXML",
      "JSONEncoding",
      "JSONEntityEscape",
      "JSONParsing",
      "LinkTo",
      "LinkToHref",
      "MailTo",
      "MassAssignment",
      "MimeTypeDoS",
      "ModelAttrAccessible",
      "ModelAttributes",
      "ModelSerialize",
      "NestedAttributes",
      "NestedAttributesBypass",
      "NumberToCurrency",
      "PageCachingCVE",
      "Pathname",
      "PermitAttributes",
      "QuoteTableName",
      "Ransack",
      "Redirect",
      "RegexDoS",
      "Render",
      "RenderDoS",
      "RenderInline",
      "ResponseSplitting",
      "ReverseTabnabbing",
      "RouteDoS",
      "SQL",
      "SQLCVEs",
      "SSLVerify",
      "SafeBufferManipulation",
      "SanitizeConfigCve",
      "SanitizeMethods",
      "Secrets",
      "SelectTag",
      "SelectVulnerability",
      "Send",
      "SendFile",
      "SessionManipulation",
      "SessionSettings",
      "SimpleFormat",
      "SingleQuotes",
      "SkipBeforeFilter",
      "SprocketsPathTraversal",
      "StripTags",
      "SymbolDoS",
      "SymbolDoSCVE",
      "TemplateInjection",
      "TranslateBug",
      "UnsafeReflection",
      "UnsafeReflectionMethods",
      "UnscopedFind",
      "ValidationRegex",
      "VerbConfusion",
      "WeakHash",
      "WeakRSAKey",
      "WithoutProtection",
      "XMLDoS",
      "YAMLParsing"
    ],
    "number_of_controllers": 1055,
    "number_of_models": 1043,
    "number_of_templates": 4410,
    "ruby_version": "3.2.6",
    "brakeman_version": "7.0.2"
  },
  "warnings": [
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "01ba4971adb557936de3ada5db143b929b8ed95b4eb2de46c2df42d97a739757",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/memo/messages_controller.rb",
      "line": 407,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:redirect] or (opts[:redirect] or { :action => :index })), :notice => @item.errors.full_messages.join(\"\\n\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Memo::MessagesController",
        "method": "render_change"
      },
      "user_input": "params[:redirect]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "0e73b3848781894dacedeaefab5f499698c2fbadb5225e7e0d3746a049ece453",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "app/models/concerns/cms/addon/history_list.rb",
      "line": 23,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.hexdigest((\"#{id}_#{loop_liquid}\" or \"#{id}_#{upper_html}_#{loop_html}_#{lower_html}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cms::Addon::HistoryList",
        "method": "list_identity"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "10c9f993b1eeaa0d57a6dc130b80755c6c1ff9ef6b4b8537920a060a5e811669",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "app/helpers/event/ical_helper.rb",
      "line": 38,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.hexdigest((\"#{@cur_site.domain}#{item.url}@#{index}\".sub(/\\.html$/, \"\").gsub(/[^0-9A-Za-z-]+/, \"-\") + SS::Crypto.salt))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Event::IcalHelper",
        "method": "event_to_ical"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "13165ea53e68f48719f4bcd35e361b57edf686040886047e85380bb3385bf991",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/board/posts/_show.html.erb",
      "line": 16,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(@item.poster_url, @item.poster_url, :target => :_blank)",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "board/posts/_show"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "1f54aa1a6dea3494f0118c2b581dc5d05daab331e261c44f365c33614acdd443",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on parameter value",
      "file": "app/views/history/cms/trashes/show.html.erb",
      "line": 90,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "@model.site(@cur_site).find(params[:id]).model.fields[k].association.class_name.constantize",
      "render_path": [
        {
          "type": "controller",
          "class": "History::Cms::TrashesController",
          "method": "show",
          "line": 138,
          "file": "app/controllers/concerns/cms/crud_filter.rb",
          "rendered": {
            "name": "history/cms/trashes/show",
            "file": "app/views/history/cms/trashes/show.html.erb"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "history/cms/trashes/show"
      },
      "user_input": "params[:id]",
      "confidence": "Medium",
      "cwe_id": [
        470
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "2148e7fea385f5c371ef84c0ed23faaca7d4c4290bc33c311809c8b5a5212249",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/affair/shift_work/calendar_controller.rb",
      "line": 141,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:ref] or url_for(:action => :index)))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Affair::ShiftWork::CalendarController",
        "method": "shift_record"
      },
      "user_input": "params[:ref]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "2941622414caa7ac03240e570146962b0d022e213856bf70514a2aab7621ecfc",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/opendata/agents/pages/dataset/dataset/index.html.erb",
      "line": 347,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(@cur_page.metadata_dataset_url, @cur_page.metadata_dataset_url, :target => \"_blank\")",
      "render_path": [
        {
          "type": "controller",
          "class": "Opendata::Agents::Pages::Dataset::DatasetController",
          "method": "index",
          "line": 11,
          "file": "app/controllers/concerns/cms/page_filter/view.rb",
          "rendered": {
            "name": "opendata/agents/pages/dataset/dataset/index",
            "file": "app/views/opendata/agents/pages/dataset/dataset/index.html.erb"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "opendata/agents/pages/dataset/dataset/index"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "406f5cea37f337788ffca8895a9be2fb8d2eea4e56a2d1f9c6a028f96c096fa5",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/survey/editable_files_controller.rb",
      "line": 136,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :model => (SS::File), :items => SS::File.in(:id => ([] + value.file_ids)), :filename => (\"survey_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path, :type => Gws::Compressor.new(@cur_user, :model => (SS::File), :items => SS::File.in(:id => ([] + value.file_ids)), :filename => (\"survey_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).type, :filename => Gws::Compressor.new(@cur_user, :model => (SS::File), :items => SS::File.in(:id => ([] + value.file_ids)), :filename => (\"survey_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Survey::EditableFilesController",
        "method": "zip_all_files"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :model => (SS::File), :items => SS::File.in(:id => ([] + value.file_ids)), :filename => (\"survey_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "4fee29736ae009fa404028f4176c96e3bb8a07855a6f51362b8923000f5c387e",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "app/models/concerns/voice/downloadable.rb",
      "line": 78,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.hexdigest(purge_csrf_token(html))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Voice::Downloadable",
        "method": "make_page_identity"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "539883d0b8b041d3b03727aad7d2b15256d0ef7e94b748a5baa4ae5712965316",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/workflow2/files_controller.rb",
      "line": 421,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = (params[:state] or \"all\")\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nif (params[:state] == \"destination\") then\n  OpenStruct.new(params[:s]).destination_treat_state ||= \"untreated\"\nend\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path, :type => Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = (params[:state] or \"all\")\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nif (params[:state] == \"destination\") then\n  OpenStruct.new(params[:s]).destination_treat_state ||= \"untreated\"\nend\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).type, :filename => Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = (params[:state] or \"all\")\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nif (params[:state] == \"destination\") then\n  OpenStruct.new(params[:s]).destination_treat_state ||= \"untreated\"\nend\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Workflow2::FilesController",
        "method": "download_all_attachments"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = (params[:state] or \"all\")\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nif (params[:state] == \"destination\") then\n  OpenStruct.new(params[:s]).destination_treat_state ||= \"untreated\"\nend\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "5b7af703412401eb371381f8d6e6c8e89fd61b7e3dcf7e9b6b7ad0c3b2f02bf1",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/cms/apis/replace_files_controller.rb",
      "line": 94,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(SS::HistoryFile.find(params[:source]).path, :type => SS::HistoryFile.find(params[:source]).content_type, :filename => SS::HistoryFile.find(params[:source]).download_filename, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cms::Apis::ReplaceFilesController",
        "method": "download"
      },
      "user_input": "SS::HistoryFile.find(params[:source]).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Missing Encryption",
      "warning_code": 109,
      "fingerprint": "6a26086cd2400fbbfb831b2f8d7291e320bcc2b36984d2abc359e41b3b63212b",
      "check_name": "ForceSSL",
      "message": "The application does not force use of HTTPS: `config.force_ssl` is not enabled",
      "file": "config/environments/production.rb",
      "line": 1,
      "link": "https://brakemanscanner.org/docs/warning_types/missing_encryption/",
      "code": null,
      "render_path": null,
      "location": null,
      "user_input": null,
      "confidence": "High",
      "cwe_id": [
        311
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "6cf22c8f5e7b3bcda0833ef24c2edc6868d91760518cd2c5e877992fc6719b97",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/opendata/agents/pages/dataset/dataset/index.html.erb",
      "line": 388,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(@cur_page.metadata_dataset_related_document, @cur_page.metadata_dataset_related_document, :target => \"_blank\")",
      "render_path": [
        {
          "type": "controller",
          "class": "Opendata::Agents::Pages::Dataset::DatasetController",
          "method": "index",
          "line": 11,
          "file": "app/controllers/concerns/cms/page_filter/view.rb",
          "rendered": {
            "name": "opendata/agents/pages/dataset/dataset/index",
            "file": "app/views/opendata/agents/pages/dataset/dataset/index.html.erb"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "opendata/agents/pages/dataset/dataset/index"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "6d5bdd0748e7b50bfcf7f2b9783fd17f0668e4755d97aa38758b2878f6723cb3",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "app/models/translate/text_cache.rb",
      "line": 45,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.hexdigest(\"#{api}_#{source}_#{target}_#{original_text}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Translate::TextCache",
        "method": "s(:self).hexdigest"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "71810bbb9b1b66e49c587a325e33b36a5a0c1f2f3d7e80a742dd2d3de3d0b2b7",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/sys/site_export_job.rb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.rm_rf(\"#{self.class.export_root}/site-#{Cms::Site.find(site.id).host}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sys::SiteExportJob",
        "method": "perform"
      },
      "user_input": "Cms::Site.find(site.id).host",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "71810bbb9b1b66e49c587a325e33b36a5a0c1f2f3d7e80a742dd2d3de3d0b2b7",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/sys/site_export_job.rb",
      "line": 71,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.rm_rf(\"#{self.class.export_root}/site-#{Cms::Site.find(site.id).host}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sys::SiteExportJob",
        "method": "perform"
      },
      "user_input": "Cms::Site.find(site.id).host",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "72c9f402fd59115c191c7cce6b97662271e77574b71e9ec112af76b4894377a7",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/opendata/agents/nodes/dataset/dataset_graph/search.html.erb",
      "line": 62,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(item.name, item.url, :target => \"_blank\")",
      "render_path": [
        {
          "type": "controller",
          "class": "Opendata::Agents::Nodes::Dataset::DatasetGraphController",
          "method": "search",
          "line": 65,
          "file": "app/controllers/opendata/agents/nodes/dataset/dataset_graph_controller.rb",
          "rendered": {
            "name": "opendata/agents/nodes/dataset/dataset_graph/search",
            "file": "app/views/opendata/agents/nodes/dataset/dataset_graph/search.html.erb"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "opendata/agents/nodes/dataset/dataset_graph/search"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "Authentication",
      "warning_code": 101,
      "fingerprint": "73c8990df5f1ac433518eea928c9fcdb4f7cbab950a295a7f8281016b237fb8b",
      "check_name": "Secrets",
      "message": "Hardcoded value for `DEFAULT_PASSWORD` in source code",
      "file": "app/models/sys/auth/setting.rb",
      "line": 8,
      "link": "https://brakemanscanner.org/docs/warning_types/authentication/",
      "code": null,
      "render_path": null,
      "location": null,
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        798
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "752067929da588b3f08ecbdd936fe14720e53f61bc57030770ff866297ef5232",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/workflow/files_controller.rb",
      "line": 301,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = params[:state] if params[:state]\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path, :type => Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = params[:state] if params[:state]\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).type, :filename => Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = params[:state] if params[:state]\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Workflow::FilesController",
        "method": "download_all_attachments"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :items => self.class.model_class.site(Gws::Group.find(params[:site])).without_deleted.search(s = OpenStruct.new(params[:s])\nOpenStruct.new(params[:s]).state = params[:state] if params[:state]\nOpenStruct.new(params[:s]).cur_site = Gws::Group.find(params[:site])\nOpenStruct.new(params[:s]).cur_user = @cur_user\nOpenStruct.new(params[:s])).collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "7acfb4f9c346449b938e43f01d1f85121c3cd76c08eb5f5663f864ddbcb53143",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "lib/ss/crypto.rb",
      "line": 16,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.digest(str)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SS::Crypto",
        "method": "s(:self).crypt"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "7b7db7ae88e7806b7d80dd7d3469af3176d66a91d0f27d26ef641e781cda6755",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/opendata/dataset/export_job.rb",
      "line": 11,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.mkdir_p(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path.sub(::File.extname(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path), \"\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Dataset::ExportJob",
        "method": "perform"
      },
      "user_input": "SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path.sub(::File.extname(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path), \"\")",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "7cadad9a5f4aad898aa7eb5579b1b2cc5afbd7acc13c535c407637954bb5cd43",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/opendata/dataset/export_job.rb",
      "line": 20,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.rm_rf(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path.sub(::File.extname(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path), \"\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Dataset::ExportJob",
        "method": "perform"
      },
      "user_input": "SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path.sub(::File.extname(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path), \"\")",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "7cadad9a5f4aad898aa7eb5579b1b2cc5afbd7acc13c535c407637954bb5cd43",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/opendata/dataset/export_job.rb",
      "line": 9,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.rm_rf(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path.sub(::File.extname(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path), \"\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Dataset::ExportJob",
        "method": "perform"
      },
      "user_input": "SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path.sub(::File.extname(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path), \"\")",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "7d32c742f6e6985182427798eea0b5e763575956e89c4ae3574b028587103401",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: SHA1",
      "file": "app/models/ezine/entry.rb",
      "line": 98,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::SHA1.hexdigest(SecureRandom.uuid)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Ezine::Entry",
        "method": "unique_token"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "7fbed5f3614e218a596ef2567e0debd3ebec74f61966c4b026098f75102c082d",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/concerns/gws/monitor/topic_filter.rb",
      "line": 214,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(SS::ZipCreator.new(\"gws_monitor_topic_files.zip\", @cur_user, :cur_site => (@cur_site)).path, :type => \"application/zip\", :filename => (\"gws_monitor_topic_files_#{Time.zone.now.to_i}.zip\"), :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Monitor::TopicFilter",
        "method": "all_topic_files"
      },
      "user_input": "SS::ZipCreator.new(\"gws_monitor_topic_files.zip\", @cur_user, :cur_site => (@cur_site)).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "7fdb0082776c99815c770bf63290417b3f0698bdd711abfe5019a240d827a973",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/affair/attendance/time_cards_controller.rb",
      "line": 161,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:ref] or { :action => :index }), :notice => t(\"gws/attendance.already_locked\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Affair::Attendance::TimeCardsController",
        "method": "enter"
      },
      "user_input": "params[:ref]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "86d86d7986e6d7d9b3e17b1eccc9c23e790c9f9a54ffbe5e15f8a44ab485e0de",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/workflow/files_controller.rb",
      "line": 276,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path, :type => Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).type, :filename => Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Workflow::FilesController",
        "method": "download_attachment"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "86e72c05bac17a8fdbb1c526e912bd4f9c77aa8f87507de841e8dbd1c7cca65d",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/attendance/time_cards_controller.rb",
      "line": 127,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:ref] or { :action => :index }), :notice => t(\"gws/attendance.already_locked\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Attendance::TimeCardsController",
        "method": "enter"
      },
      "user_input": "params[:ref]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "8714dcb3983f6fb6d00b2ef8fb89704049de67b27a356c07c76765843cfd67c1",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: SHA1",
      "file": "app/models/voice/file.rb",
      "line": 60,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::SHA1.hexdigest(id.to_s)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Voice::File",
        "method": "file"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "87d95b861038af8ad8fa0073b209e538d0e9c5fbbaf1cbe0908e8d7a0c56ac00",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/article/agents/addons/form_export/_show.html.erb",
      "line": 5,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(@item.export_json_url, @item.export_json_url, :target => \"_blank\")",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "article/agents/addons/form_export/_show"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "88c593503b36fed8b9bc44d119a729ecc3e59c616dbc717f33eaf9338cd2f771",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/chorg/entity_logs_controller.rb",
      "line": 76,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(::Chorg::EntityLog::Exporter.new(Gws::Chorg::Task.site(Gws::Group.find(params[:site])).and_revision(Gws::Chorg::Revision.find(params[:rid])).where(:name => (\"gws:chorg:#{params[:type]}_task\")).order_by(:created => -1).first_or_create, Gws::Group.find(params[:site]), request.base_url).path, :filename => ::Chorg::EntityLog::Exporter.new(Gws::Chorg::Task.site(Gws::Group.find(params[:site])).and_revision(Gws::Chorg::Revision.find(params[:rid])).where(:name => (\"gws:chorg:#{params[:type]}_task\")).order_by(:created => -1).first_or_create, Gws::Group.find(params[:site]), request.base_url).filename, :type => SS::MimeType.find(\"zip\", \"application/zip\"), :disposition => :attachment, :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Chorg::EntityLogsController",
        "method": "download"
      },
      "user_input": "::Chorg::EntityLog::Exporter.new(Gws::Chorg::Task.site(Gws::Group.find(params[:site])).and_revision(Gws::Chorg::Revision.find(params[:rid])).where(:name => (\"gws:chorg:#{params[:type]}_task\")).order_by(:created => -1).first_or_create, Gws::Group.find(params[:site]), request.base_url).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "8c5101ff2f0ef77b76457bc1263df7c3b5e84b6a02e5d338ead872b9c5b2ace4",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/chorg/entity_logs_controller.rb",
      "line": 74,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(::Chorg::EntityLog::Exporter.new(Chorg::Task.site(@cur_site).and_revision(Chorg::Revision.find(params[:rid])).where(:name => (\"chorg:#{params[:type]}_task\")).order_by(:created => -1).first_or_create, @cur_site, request.base_url).path, :filename => ::Chorg::EntityLog::Exporter.new(Chorg::Task.site(@cur_site).and_revision(Chorg::Revision.find(params[:rid])).where(:name => (\"chorg:#{params[:type]}_task\")).order_by(:created => -1).first_or_create, @cur_site, request.base_url).filename, :type => SS::MimeType.find(\"zip\", \"application/zip\"), :disposition => :attachment, :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Chorg::EntityLogsController",
        "method": "download"
      },
      "user_input": "::Chorg::EntityLog::Exporter.new(Chorg::Task.site(@cur_site).and_revision(Chorg::Revision.find(params[:rid])).where(:name => (\"chorg:#{params[:type]}_task\")).order_by(:created => -1).first_or_create, @cur_site, request.base_url).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "8f5809b76a2d0fa30fb1c6646b32514cbbea7a8c6add6cba018c20e2db4ae670",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/controllers/opendata/agents/nodes/app/appfile_controller.rb",
      "line": 46,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "File.read(Opendata::App.site(@cur_site).and_public(@cur_date).filename(@cur_main_path.sub(/\\/appfile\\/.*/, \".html\")).first.appfiles.find_by(:id => params[:id], :format => \"JSON\").file.path, :encoding => (Encoding::UTF_8))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Agents::Nodes::App::AppfileController",
        "method": "json"
      },
      "user_input": "Opendata::App.site(@cur_site).and_public(@cur_date).filename(@cur_main_path.sub(/\\/appfile\\/.*/, \".html\")).first.appfiles.find_by(:id => params[:id], :format => \"JSON\").file.path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "90217abbff62e6bea8727a3688d99f2d47d0d55bfce9f7789b041ffe980f17a6",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "app/jobs/concerns/rss/downloadable.rb",
      "line": 41,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.hexdigest(url)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Rss::Downloadable",
        "method": "download_with_cache"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 70,
      "fingerprint": "915020a2c645c40dc57fad2fe52079aa6651f0c457122cc212b8a758181b7c59",
      "check_name": "MassAssignment",
      "message": "Specify exact keys allowed for mass assignment instead of using `permit!` which allows any keys",
      "file": "app/controllers/cms/preview_controller.rb",
      "line": 76,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "params.require(:preview_item).permit!",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cms::PreviewController",
        "method": "set_form_data"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        915
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "94294de6956444714fc04d8d484f0afbabc5b3a0c361e475d0fee9fc596783cb",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "app/helpers/gravatar/gravatar_helper.rb",
      "line": 4,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::MD5.hexdigest(email)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gravatar::GravatarHelper",
        "method": "gravatar_image_url"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "9bb2d52aa1490aba6d250194aab67404fbc03df55b5b4d7b47fc6a1c862d91af",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/models/concerns/history/model/data.rb",
      "line": 148,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.cp(\"#{History::Trash.root}/#{History::Trash.where(:ref_coll => \"ss_files\", \"data._id\" => file_id).first.restore(opts).path.sub(/.*\\/(ss_files\\/)/, \"\\\\1\")}\", History::Trash.where(:ref_coll => \"ss_files\", \"data._id\" => file_id).first.restore(opts).path)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "History::Model::Data",
        "method": "restore_file"
      },
      "user_input": "History::Trash.root",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "9f06b9e7508846d0cc0f0ad1962217d44a441128c44ff587eda891bfc91f4673",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/workflow2/files_controller.rb",
      "line": 396,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path, :type => Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).type, :filename => Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Workflow2::FilesController",
        "method": "download_attachment"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :items => @item.collect_attachments, :filename => (\"workflow_#{Time.zone.now.strftime(\"%Y%m%d_%H%M%S\")}.zip\")).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "a409ad46b370606712d9c0e1add9d8cdfacb8dbe8f2a2f8db6983d10b649577f",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/opendata/agents/nodes/app/app_controller.rb",
      "line": 77,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Opendata::App.site(@cur_site).filename(Opendata::App.to_app_path(@cur_main_path)).first.create_zip, :type => \"application/zip\", :filename => (\"#{Opendata::App.site(@cur_site).filename(Opendata::App.to_app_path(@cur_main_path)).first.name}.zip\"), :disposition => :attachment, :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Agents::Nodes::App::AppController",
        "method": "download"
      },
      "user_input": "Opendata::App.site(@cur_site).filename(Opendata::App.to_app_path(@cur_main_path)).first.create_zip",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 70,
      "fingerprint": "a6b2ae8eea81debd5c4aaf3468f98be26bbf51a5d5ed7eba553866a939aee2f4",
      "check_name": "MassAssignment",
      "message": "Specify exact keys allowed for mass assignment instead of using `permit!` which allows any keys",
      "file": "app/controllers/article/agents/nodes/map_search_controller.rb",
      "line": 15,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "params[:columns].permit!",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Article::Agents::Nodes::MapSearchController",
        "method": "set_query"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        915
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "ab372f0011bc54085a9441469af9582deb02b69426d3716c85810b97139feaf6",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: MD5",
      "file": "lib/ss/random_color.rb",
      "line": 95,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "::Digest::MD5.hexdigest((seed.to_s + SALT))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SS::RandomColor",
        "method": "initialize"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "ae97eef52dea610340e9973682e8d626a577f1fbcdc56d5e7256128c4202cd01",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on parameter value",
      "file": "app/views/history/cms/trashes/show.html.erb",
      "line": 77,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "@model.site(@cur_site).find(params[:id]).model.fields[k].options[:metadata][:elem_class].constantize",
      "render_path": [
        {
          "type": "controller",
          "class": "History::Cms::TrashesController",
          "method": "show",
          "line": 138,
          "file": "app/controllers/concerns/cms/crud_filter.rb",
          "rendered": {
            "name": "history/cms/trashes/show",
            "file": "app/views/history/cms/trashes/show.html.erb"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "history/cms/trashes/show"
      },
      "user_input": "params[:id]",
      "confidence": "Medium",
      "cwe_id": [
        470
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "b184a81af16ced3fc988d95cfc0c30c9f8fa871b31c9186e5ef0c579db86d67d",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/share/files_controller.rb",
      "line": 297,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :items => ((self.class.model_class.in(:id => params[:ids].split(\",\")).site(Gws::Group.find(params[:site])) or self.class.model_class.in(:id => params[:ids].split(\",\"))))).path, :type => Gws::Compressor.new(@cur_user, :items => ((self.class.model_class.in(:id => params[:ids].split(\",\")).site(Gws::Group.find(params[:site])) or self.class.model_class.in(:id => params[:ids].split(\",\"))))).type, :filename => Gws::Compressor.new(@cur_user, :items => ((self.class.model_class.in(:id => params[:ids].split(\",\")).site(Gws::Group.find(params[:site])) or self.class.model_class.in(:id => params[:ids].split(\",\"))))).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Share::FilesController",
        "method": "download_all"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :items => ((self.class.model_class.in(:id => params[:ids].split(\",\")).site(Gws::Group.find(params[:site])) or self.class.model_class.in(:id => params[:ids].split(\",\"))))).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "b5e758b7ea91fde8dbd86538920d03516ffc9b2c9fc4510b300eabc9fda77132",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/webmail/mails_controller.rb",
      "line": 422,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:redirect] or (opts[:redirect] or { :action => :index })), :notice => I18n.t(\"ss.notice.saved\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Webmail::MailsController",
        "method": "render_change"
      },
      "user_input": "params[:redirect]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "b606d1e6bbdeb949976e0fb55c3d2b98e647b92d9c686d8d3f2738666c845803",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: SHA1",
      "file": "app/models/concerns/sys/addon/saml_setting.rb",
      "line": 58,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "Digest::SHA1.hexdigest(OpenSSL::X509::Certificate.new(SS::Crypto.decrypt(x509_cert)).to_der)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sys::Addon::SamlSetting",
        "method": "fingerprint"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "b69a991f3c8faa9a8469958cf55757b77193df4acebb3a1f025da912ba279026",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/cms.rb",
      "line": 349,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "Open3.popen3(*((((SS.config.cms.sass[\"commands\"] << \"--load-path=#{Rails.root.to_s[(0..-2)]}\") << \"--load-path=#{_1}\") << ::File.expand_path(source_path, Rails.root.to_s[(0..-2)]).sub(Rails.root.to_s[(0..-2)], \"\")[(1..-1)]) << ::File.expand_path(output_path, Rails.root.to_s[(0..-2)]).sub(Rails.root.to_s[(0..-2)], \"\")[(1..-1)]), :chdir => Rails.root.to_s[(0..-2)])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cms",
        "method": "Cms.compile_scss"
      },
      "user_input": "Rails.root.to_s[(0..-2)]",
      "confidence": "Medium",
      "cwe_id": [
        77
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "b6fe986cd25773675d1a1100a4aacf211958a7bd3b74d31ec89b15df2997d1ee",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/inquiry/agents/addons/answer/body/_show.html.erb",
      "line": 45,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(@item.inquiry_page_content.full_url, @item.inquiry_page_content.full_url, :target => \"_blank\")",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "inquiry/agents/addons/answer/body/_show"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "bb1ebbcee4ae02f9c244031956fe4845a300a2a7b6a067cb6eebd4368af2e088",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/opendata/agents/nodes/app/appfile_controller.rb",
      "line": 29,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Opendata::App.site(@cur_site).and_public(@cur_date).filename(@cur_main_path.sub(/\\/appfile\\/.*/, \".html\")).first.appfiles.find_by(:id => params[:id], :filename => params[:filename].force_encoding(\"utf-8\")).file.path, :type => Opendata::App.site(@cur_site).and_public(@cur_date).filename(@cur_main_path.sub(/\\/appfile\\/.*/, \".html\")).first.appfiles.find_by(:id => params[:id], :filename => params[:filename].force_encoding(\"utf-8\")).content_type, :filename => Opendata::App.site(@cur_site).and_public(@cur_date).filename(@cur_main_path.sub(/\\/appfile\\/.*/, \".html\")).first.appfiles.find_by(:id => params[:id], :filename => params[:filename].force_encoding(\"utf-8\")).filename, :disposition => :attachment, :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Agents::Nodes::App::AppfileController",
        "method": "download"
      },
      "user_input": "Opendata::App.site(@cur_site).and_public(@cur_date).filename(@cur_main_path.sub(/\\/appfile\\/.*/, \".html\")).first.appfiles.find_by(:id => params[:id], :filename => params[:filename].force_encoding(\"utf-8\")).file.path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "c15caa8cbfe21957bf86bb5e5f6bbb16dd5f648f2411f74a47e1f67a82fa1402",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/concerns/member/line/login_filter.rb",
      "line": 15,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(Member::Node::LineFirstRegistration.site(@cur_site).first.url)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Member::Line::LoginFilter",
        "method": "redirect_first_registration"
      },
      "user_input": "Member::Node::LineFirstRegistration.site(@cur_site).first.url",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "c472668fdbcbf147ddcd9d472bac3a838aadca8ae2598f24b320c3a1e38269d2",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/affair/overtime/results_controller.rb",
      "line": 35,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:ref] or view_context.gws_affair_main_path), :notice => I18n.t(\"gws/affair.notice.close_results\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Affair::Overtime::ResultsController",
        "method": "close"
      },
      "user_input": "params[:ref]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "c61697d1e5bef3502832b2c39ba26d873308adca6e82711febae6148e642c4b8",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/concerns/opendata/pdf_parseable.rb",
      "line": 12,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "Open3.capture3((SS.config.opendata.preview[\"pdf\"][\"parse_command\"] + \" \\\"#{file.path}\\\" \\\"#{SS.config.opendata.preview[\"pdf\"][\"page_limit\"]}\\\"\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::PdfParseable",
        "method": "extract_pdf_base64_images"
      },
      "user_input": "file.path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "cb0b42267535bcc42852d1f863b04484f066bd239bfb1cc8e0aa11ae4b732760",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/opendata/agents/nodes/dataset/search_dataset_controller.rb",
      "line": 70,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Opendata::Dataset.site(@cur_site).and_public(@cur_date).find_by(:id => params[:id]).zip_path, :type => \"application/zip\", :filename => (\"#{Opendata::Dataset.site(@cur_site).and_public(@cur_date).find_by(:id => params[:id]).name}_#{Time.zone.now.to_i}.zip\"), :disposition => :attachment, :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Agents::Nodes::Dataset::SearchDatasetController",
        "method": "dataset_download"
      },
      "user_input": "Opendata::Dataset.site(@cur_site).and_public(@cur_date).find_by(:id => params[:id]).zip_path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "cc13d96cbd00a0776e9507d85649dd680af03293dfc04191751ea1ab54d67f50",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/member/agents/nodes/line_first_registration_controller.rb",
      "line": 34,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(Member::Node::Mypage.site(@cur_site).first.url)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Member::Agents::Nodes::LineFirstRegistrationController",
        "method": "index"
      },
      "user_input": "Member::Node::Mypage.site(@cur_site).first.url",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "d0472c5984437514cc53de0aa2224655c6675f72e39f18ce8f71a4d95bab2499",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/gws/share/folders_controller.rb",
      "line": 116,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Compressor.new(@cur_user, :items => SS::File.where(:folder_id => params[:id].to_i, :deleted => nil), :name => (\"#{@item.trailing_name}.zip\")).path, :type => Gws::Compressor.new(@cur_user, :items => SS::File.where(:folder_id => params[:id].to_i, :deleted => nil), :name => (\"#{@item.trailing_name}.zip\")).type, :filename => Gws::Compressor.new(@cur_user, :items => SS::File.where(:folder_id => params[:id].to_i, :deleted => nil), :name => (\"#{@item.trailing_name}.zip\")).name, :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Share::FoldersController",
        "method": "download_folder"
      },
      "user_input": "Gws::Compressor.new(@cur_user, :items => SS::File.where(:folder_id => params[:id].to_i, :deleted => nil), :name => (\"#{@item.trailing_name}.zip\")).path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Weak Hash",
      "warning_code": 90,
      "fingerprint": "d75342e402d3d359a11ff7f2a8b8d07d64b257e3bc12f1ac33b75cef62c6a302",
      "check_name": "WeakHash",
      "message": "Weak hashing algorithm used: SHA1",
      "file": "app/models/ss/oauth2/application/service.rb",
      "line": 23,
      "link": "https://brakemanscanner.org/docs/warning_types/weak_hash/",
      "code": "OpenSSL::Digest::SHA1.hexdigest(public_key.to_der)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SS::OAuth2::Application::Service",
        "method": "public_key_finger_print"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        328
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "d8048a024fd4502cbb73823579310e91831062e00d1cf14bfb20877fce05a976",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/sys/site_export_job.rb",
      "line": 28,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.mkdir_p(\"#{self.class.export_root}/site-#{Cms::Site.find(site.id).host}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sys::SiteExportJob",
        "method": "perform"
      },
      "user_input": "Cms::Site.find(site.id).host",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "dbf171d97635370f817d745d76fdf8e147eb88736810cb3fd2bcd6b2e9736815",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/memo/messages_controller.rb",
      "line": 402,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:redirect] or (opts[:redirect] or { :action => :index })), :notice => I18n.t(\"ss.notice.saved\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Memo::MessagesController",
        "method": "render_change"
      },
      "user_input": "params[:redirect]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "dcc8e4a21e2c388fd0abe1c42d239e0e62bc13c1b23c43544b4b66e10bce0eac",
      "check_name": "FileAccess",
      "message": "Model attribute used in file name",
      "file": "app/jobs/opendata/dataset/export_job.rb",
      "line": 10,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.rm_rf(SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Opendata::Dataset::ExportJob",
        "method": "perform"
      },
      "user_input": "SS::DownloadJobFile.new(user, \"opendata-datasets-#{Time.zone.now.to_i}.zip\").path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "e7df781af35691e89bf620df323532bc6ae09643ea7d296ffe159cbb70752e9a",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/opendata/agents/pages/dataset/dataset/index.html.erb",
      "line": 170,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to((tryb do\n image_tag(rs.license.file.url, :alt => rs.license.name)\n end or rs.license.name), rs.license.related_url, :target => \"_blank\", :rel => ([\"noopener\", @cur_site.anti_bot_set_nofollow? ? (\"nofollow\") : (nil)]))",
      "render_path": [
        {
          "type": "controller",
          "class": "Opendata::Agents::Pages::Dataset::DatasetController",
          "method": "index",
          "line": 11,
          "file": "app/controllers/concerns/cms/page_filter/view.rb",
          "rendered": {
            "name": "opendata/agents/pages/dataset/dataset/index",
            "file": "app/views/opendata/agents/pages/dataset/dataset/index.html.erb"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "opendata/agents/pages/dataset/dataset/index"
      },
      "user_input": "[\"noopener\", @cur_site.anti_bot_set_nofollow? ? (\"nofollow\") : (nil)]",
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "f2078da12fc4bb9dc9eb41699d0f57ba079343b144aa5ff93dbd432e12d8b61d",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/controllers/concerns/gws/monitor/topic_filter.rb",
      "line": 198,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(Gws::Monitor::TopicZipCreator.new(:cur_site => (@cur_site), :cur_user => (@cur_user), :cur_group => (@cur_group), :topic => (@item)).zip_path, :type => \"application/zip\", :filename => SS::FilenameUtils.convert_to_url_safe_japanese(\"#{@item.name}.zip\"), :disposition => \"attachment\", :x_sendfile => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Monitor::TopicFilter",
        "method": "file_download"
      },
      "user_input": "Gws::Monitor::TopicZipCreator.new(:cur_site => (@cur_site), :cur_user => (@cur_user), :cur_group => (@cur_group), :topic => (@item)).zip_path",
      "confidence": "Medium",
      "cwe_id": [
        22
      ]
    },
    {
      "warning_type": "Reverse Tabnabbing",
      "warning_code": 111,
      "fingerprint": "f3b451f2ee5f2927789855415d2ddf25f3291009d9cb034979134e73b1ab93da",
      "check_name": "ReverseTabnabbing",
      "message": "When opening a link in a new tab without setting `rel: \"noopener noreferrer\"`, the new tab can control the parent tab's location. For example, an attacker could redirect to a phishing page.",
      "file": "app/views/article/agents/addons/form_export/_show.html.erb",
      "line": 4,
      "link": "https://brakemanscanner.org/docs/warning_types/reverse_tabnabbing/",
      "code": "link_to(@item.export_csv_url, @item.export_csv_url, :target => \"_blank\")",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "article/agents/addons/form_export/_show"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        1022
      ]
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "ff94eeaa64a330c36a26ac15a7026c61999e8a038e48512b788ba7566a40c4d8",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/gws/memo/messages_controller.rb",
      "line": 423,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((params[:redirect] or (opts[:redirect] or { :action => :index })), :notice => I18n.t(\"ss.notice.saved\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Gws::Memo::MessagesController",
        "method": "render_change_all"
      },
      "user_input": "params[:redirect]",
      "confidence": "High",
      "cwe_id": [
        601
      ]
    }
  ],
  "ignored_warnings": [],
  "errors": [],
  "obsolete": []
}